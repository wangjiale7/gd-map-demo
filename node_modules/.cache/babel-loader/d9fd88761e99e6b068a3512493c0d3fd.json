{"remainingRequest":"/Users/jiale/development/front/map-vue-demo/node_modules/thread-loader/dist/cjs.js!/Users/jiale/development/front/map-vue-demo/node_modules/babel-loader/lib/index.js!/Users/jiale/development/front/map-vue-demo/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/jiale/development/front/map-vue-demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jiale/development/front/map-vue-demo/src/components/Sticky/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jiale/development/front/map-vue-demo/src/components/Sticky/index.vue","mtime":1669134425238},{"path":"/Users/jiale/development/front/map-vue-demo/babel.config.js","mtime":1668588369343},{"path":"/Users/jiale/development/front/map-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jiale/development/front/map-vue-demo/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jiale/development/front/map-vue-demo/node_modules/babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/jiale/development/front/map-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jiale/development/front/map-vue-demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTdGlja3knLAogIHByb3BzOiB7CiAgICBzdGlja3lUb3A6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAwCiAgICB9LAogICAgekluZGV4OiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogMQogICAgfSwKICAgIGNsYXNzTmFtZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICcnCiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYWN0aXZlOiBmYWxzZSwKICAgICAgcG9zaXRpb246ICcnLAogICAgICB3aWR0aDogdW5kZWZpbmVkLAogICAgICBoZWlnaHQ6IHVuZGVmaW5lZCwKICAgICAgaXNTdGlja3k6IGZhbHNlLAogICAgICBzY3JvbGxEb206IG51bGwsCiAgICAgIGxlZnQ6IDAKICAgIH07CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5zY3JvbGxEb20gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZHJhd2VyLXdyYXAgLmVsLWRyYXdlcl9fYm9keScpOwogICAgdGhpcy5oZWlnaHQgPSB0aGlzLiRlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7CiAgICB0aGlzLnNjcm9sbERvbS5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLmhhbmRsZVNjcm9sbCk7CiAgICB0aGlzLnNjcm9sbERvbS5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLmhhbmRsZVJlc2l6ZSk7CiAgfSwKICBhY3RpdmF0ZWQoKSB7CiAgICB0aGlzLmhhbmRsZVNjcm9sbCgpOwogIH0sCiAgZGVzdHJveWVkKCkgewogICAgY29uc29sZS5sb2coJ2Rlc3Ryb3llZCcpOwogICAgdGhpcy5zY3JvbGxEb20ucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5oYW5kbGVTY3JvbGwpOwogICAgdGhpcy5zY3JvbGxEb20ucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5oYW5kbGVSZXNpemUpOwogIH0sCiAgbWV0aG9kczogewogICAgc3RpY2t5KCkgewogICAgICBpZiAodGhpcy5hY3RpdmUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5wb3NpdGlvbiA9ICdmaXhlZCc7CiAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTsKICAgICAgdGhpcy53aWR0aCA9IHRoaXMud2lkdGggKyAncHgnOwogICAgICB0aGlzLmlzU3RpY2t5ID0gdHJ1ZTsKICAgICAgdGhpcy5sZWZ0ID0gLWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0OwogICAgfSwKICAgIGhhbmRsZVJlc2V0KCkgewogICAgICBpZiAoIXRoaXMuYWN0aXZlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMucmVzZXQoKTsKICAgIH0sCiAgICByZXNldCgpIHsKICAgICAgdGhpcy5wb3NpdGlvbiA9ICcnOwogICAgICB0aGlzLndpZHRoID0gJ2F1dG8nOwogICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLmlzU3RpY2t5ID0gZmFsc2U7CiAgICB9LAogICAgaGFuZGxlU2Nyb2xsKCkgewogICAgICBjb25zdCB3aWR0aCA9IHRoaXMuJGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoOwogICAgICB0aGlzLndpZHRoID0gd2lkdGggfHwgJ2F1dG8nOwogICAgICBjb25zdCBvZmZzZXRUb3AgPSB0aGlzLiRlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7CiAgICAgIGNvbnNvbGUubG9nKG9mZnNldFRvcCk7CiAgICAgIGlmIChvZmZzZXRUb3AgPCB0aGlzLnN0aWNreVRvcCkgewogICAgICAgIHRoaXMuc3RpY2t5KCk7CiAgICAgICAgaWYgKG9mZnNldFRvcCA9PT0gMCkgewogICAgICAgICAgdGhpcy5oYW5kbGVSZXNldCgpOwogICAgICAgIH0KICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5oYW5kbGVSZXNldCgpOwogICAgfSwKICAgIGhhbmRsZVJlc2l6ZSgpIHsKICAgICAgaWYgKHRoaXMuaXNTdGlja3kpIHsKICAgICAgICB0aGlzLndpZHRoID0gdGhpcy4kZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggKyAncHgnOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":"AAqBA;EACAA;EACAC;IACAC;MACAC;MACAC;IACA;IACAC;MACAF;MACAC;IACA;IACAE;MACAH;MACAC;IACA;EACA;EACAG;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;IAEA;IACA;IACA;EACA;EACAC;IACA;EACA;EACAC;IACAC;IACA;IACA;EACA;EACAC;IACAC;MACA;QACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACAL;MAEA;QACA;QACA;UACA;QACA;QACA;MACA;MACA;IACA;IACAM;MACA;QACA;MACA;IACA;EACA;AACA","names":["name","props","stickyTop","type","default","zIndex","className","data","active","position","width","height","isSticky","scrollDom","left","mounted","activated","destroyed","console","methods","sticky","handleReset","reset","handleScroll","handleResize"],"sourceRoot":"src/components/Sticky","sources":["index.vue"],"sourcesContent":["<template>\n  <div :style=\"{ height: height + 'px', zIndex: zIndex }\">\n    <div\n      :class=\"className\"\n      :style=\"{\n        top: isSticky ? stickyTop + 'px' : '',\n        zIndex: zIndex,\n        position: position,\n        width: width,\n        height: height + 'px',\n        transform: `translateX(${left}px)`\n      }\"\n    >\n      <slot>\n        <div>sticky</div>\n      </slot>\n    </div>\n  </div>\n</template>\n\n<script>\n  export default {\n    name: 'Sticky',\n    props: {\n      stickyTop: {\n        type: Number,\n        default: 0\n      },\n      zIndex: {\n        type: Number,\n        default: 1\n      },\n      className: {\n        type: String,\n        default: ''\n      }\n    },\n    data() {\n      return {\n        active: false,\n        position: '',\n        width: undefined,\n        height: undefined,\n        isSticky: false,\n        scrollDom: null,\n        left: 0\n      }\n    },\n    mounted() {\n      this.scrollDom = document.querySelector('#drawer-wrap .el-drawer__body')\n\n      this.height = this.$el.getBoundingClientRect().height\n      this.scrollDom.addEventListener('scroll', this.handleScroll)\n      this.scrollDom.addEventListener('resize', this.handleResize)\n    },\n    activated() {\n      this.handleScroll()\n    },\n    destroyed() {\n      console.log('destroyed')\n      this.scrollDom.removeEventListener('scroll', this.handleScroll)\n      this.scrollDom.removeEventListener('resize', this.handleResize)\n    },\n    methods: {\n      sticky() {\n        if (this.active) {\n          return\n        }\n        this.position = 'fixed'\n        this.active = true\n        this.width = this.width + 'px'\n        this.isSticky = true\n        this.left = -document.documentElement.scrollLeft\n      },\n      handleReset() {\n        if (!this.active) {\n          return\n        }\n        this.reset()\n      },\n      reset() {\n        this.position = ''\n        this.width = 'auto'\n        this.active = false\n        this.isSticky = false\n      },\n      handleScroll() {\n        const width = this.$el.getBoundingClientRect().width\n        this.width = width || 'auto'\n        const offsetTop = this.$el.getBoundingClientRect().top\n        console.log(offsetTop)\n\n        if (offsetTop < this.stickyTop) {\n          this.sticky()\n          if (offsetTop === 0) {\n            this.handleReset()\n          }\n          return\n        }\n        this.handleReset()\n      },\n      handleResize() {\n        if (this.isSticky) {\n          this.width = this.$el.getBoundingClientRect().width + 'px'\n        }\n      }\n    }\n  }\n</script>\n"]}]}