{"remainingRequest":"/Users/jiale/development/front/map-vue-demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jiale/development/front/map-vue-demo/src/components/Sticky/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jiale/development/front/map-vue-demo/src/components/Sticky/index.vue","mtime":1669134259745},{"path":"/Users/jiale/development/front/map-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jiale/development/front/map-vue-demo/node_modules/babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/jiale/development/front/map-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jiale/development/front/map-vue-demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ1N0aWNreScsCiAgICBwcm9wczogewogICAgICBzdGlja3lUb3A6IHsKICAgICAgICB0eXBlOiBOdW1iZXIsCiAgICAgICAgZGVmYXVsdDogMAogICAgICB9LAogICAgICB6SW5kZXg6IHsKICAgICAgICB0eXBlOiBOdW1iZXIsCiAgICAgICAgZGVmYXVsdDogMQogICAgICB9LAogICAgICBjbGFzc05hbWU6IHsKICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgZGVmYXVsdDogJycKICAgICAgfQogICAgfSwKICAgIGRhdGEoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgYWN0aXZlOiBmYWxzZSwKICAgICAgICBwb3NpdGlvbjogJycsCiAgICAgICAgd2lkdGg6IHVuZGVmaW5lZCwKICAgICAgICBoZWlnaHQ6IHVuZGVmaW5lZCwKICAgICAgICBpc1N0aWNreTogZmFsc2UsCiAgICAgICAgc2Nyb2xsRG9tOiBudWxsLAogICAgICAgIGxlZnQ6IHVuZGVmaW5lZAogICAgICB9CiAgICB9LAogICAgbW91bnRlZCgpIHsKICAgICAgdGhpcy5zY3JvbGxEb20gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZHJhd2VyLXdyYXAgLmVsLWRyYXdlcl9fYm9keScpCgogICAgICB0aGlzLmhlaWdodCA9IHRoaXMuJGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodAogICAgICB0aGlzLnNjcm9sbERvbS5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLmhhbmRsZVNjcm9sbCkKICAgICAgdGhpcy5zY3JvbGxEb20uYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5oYW5kbGVSZXNpemUpCiAgICB9LAogICAgYWN0aXZhdGVkKCkgewogICAgICB0aGlzLmhhbmRsZVNjcm9sbCgpCiAgICB9LAogICAgZGVzdHJveWVkKCkgewogICAgICBjb25zb2xlLmxvZygnZGVzdHJveWVkJykKICAgICAgdGhpcy5zY3JvbGxEb20ucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5oYW5kbGVTY3JvbGwpCiAgICAgIHRoaXMuc2Nyb2xsRG9tLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuaGFuZGxlUmVzaXplKQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgc3RpY2t5KCkgewogICAgICAgIGlmICh0aGlzLmFjdGl2ZSkgewogICAgICAgICAgcmV0dXJuCiAgICAgICAgfQogICAgICAgIHRoaXMucG9zaXRpb24gPSAnZml4ZWQnCiAgICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlCiAgICAgICAgdGhpcy53aWR0aCA9IHRoaXMud2lkdGggKyAncHgnCiAgICAgICAgdGhpcy5pc1N0aWNreSA9IHRydWUKICAgICAgICB0aGlzLmxlZnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdAogICAgICB9LAogICAgICBoYW5kbGVSZXNldCgpIHsKICAgICAgICBpZiAoIXRoaXMuYWN0aXZlKSB7CiAgICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICAgICAgdGhpcy5yZXNldCgpCiAgICAgIH0sCiAgICAgIHJlc2V0KCkgewogICAgICAgIHRoaXMucG9zaXRpb24gPSAnJwogICAgICAgIHRoaXMud2lkdGggPSAnYXV0bycKICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlCiAgICAgICAgdGhpcy5pc1N0aWNreSA9IGZhbHNlCiAgICAgIH0sCiAgICAgIGhhbmRsZVNjcm9sbCgpIHsKICAgICAgICBjb25zdCB3aWR0aCA9IHRoaXMuJGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoCiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoIHx8ICdhdXRvJwogICAgICAgIGNvbnN0IG9mZnNldFRvcCA9IHRoaXMuJGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcAogICAgICAgIGNvbnNvbGUubG9nKG9mZnNldFRvcCkKCiAgICAgICAgaWYgKG9mZnNldFRvcCA8IHRoaXMuc3RpY2t5VG9wKSB7CiAgICAgICAgICB0aGlzLnN0aWNreSgpCiAgICAgICAgICBpZiAob2Zmc2V0VG9wID09PSAwKSB7CiAgICAgICAgICAgIHRoaXMuaGFuZGxlUmVzZXQoKQogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuCiAgICAgICAgfQogICAgICAgIHRoaXMuaGFuZGxlUmVzZXQoKQogICAgICB9LAogICAgICBoYW5kbGVSZXNpemUoKSB7CiAgICAgICAgaWYgKHRoaXMuaXNTdGlja3kpIHsKICAgICAgICAgIHRoaXMud2lkdGggPSB0aGlzLiRlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCArICdweCcKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/Sticky","sourcesContent":["<template>\n  <div :style=\"{ height: height + 'px', zIndex: zIndex }\">\n    <div\n      :class=\"className\"\n      :style=\"{\n        top: isSticky ? stickyTop + 'px' : '',\n        zIndex: zIndex,\n        position: position,\n        width: width,\n        height: height + 'px',\n        transform: `translateX(${left} + 'px')`\n      }\"\n    >\n      <slot>\n        <div>sticky</div>\n      </slot>\n    </div>\n  </div>\n</template>\n\n<script>\n  export default {\n    name: 'Sticky',\n    props: {\n      stickyTop: {\n        type: Number,\n        default: 0\n      },\n      zIndex: {\n        type: Number,\n        default: 1\n      },\n      className: {\n        type: String,\n        default: ''\n      }\n    },\n    data() {\n      return {\n        active: false,\n        position: '',\n        width: undefined,\n        height: undefined,\n        isSticky: false,\n        scrollDom: null,\n        left: undefined\n      }\n    },\n    mounted() {\n      this.scrollDom = document.querySelector('#drawer-wrap .el-drawer__body')\n\n      this.height = this.$el.getBoundingClientRect().height\n      this.scrollDom.addEventListener('scroll', this.handleScroll)\n      this.scrollDom.addEventListener('resize', this.handleResize)\n    },\n    activated() {\n      this.handleScroll()\n    },\n    destroyed() {\n      console.log('destroyed')\n      this.scrollDom.removeEventListener('scroll', this.handleScroll)\n      this.scrollDom.removeEventListener('resize', this.handleResize)\n    },\n    methods: {\n      sticky() {\n        if (this.active) {\n          return\n        }\n        this.position = 'fixed'\n        this.active = true\n        this.width = this.width + 'px'\n        this.isSticky = true\n        this.left = document.documentElement.scrollLeft\n      },\n      handleReset() {\n        if (!this.active) {\n          return\n        }\n        this.reset()\n      },\n      reset() {\n        this.position = ''\n        this.width = 'auto'\n        this.active = false\n        this.isSticky = false\n      },\n      handleScroll() {\n        const width = this.$el.getBoundingClientRect().width\n        this.width = width || 'auto'\n        const offsetTop = this.$el.getBoundingClientRect().top\n        console.log(offsetTop)\n\n        if (offsetTop < this.stickyTop) {\n          this.sticky()\n          if (offsetTop === 0) {\n            this.handleReset()\n          }\n          return\n        }\n        this.handleReset()\n      },\n      handleResize() {\n        if (this.isSticky) {\n          this.width = this.$el.getBoundingClientRect().width + 'px'\n        }\n      }\n    }\n  }\n</script>\n"]}]}